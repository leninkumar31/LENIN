i think this problem has ambiguity..
we no need to consider second condition(note:i may be wrong)
to solve this kind of problems we need to remember two things:
 1)what we are going to store in segment tree node
 2)how we are merging left and right part
if you find out what are thos two things.remaining is cake walk.. :p